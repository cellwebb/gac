# Использование командной строки gac

[English](../en/USAGE.md) | [简体中文](../zh-CN/USAGE.md) | [繁體中文](../zh-TW/USAGE.md) | [日本語](../ja/USAGE.md) | [한국어](../ko/USAGE.md) | [हिन्दी](../hi/USAGE.md) | [Tiếng Việt](../vi/USAGE.md) | [Français](../fr/USAGE.md) | **Русский** | [Español](../es/USAGE.md) | [Português](../pt/USAGE.md) | [Norsk](../no/USAGE.md) | [Svenska](../sv/USAGE.md) | [Deutsch](../de/USAGE.md) | [Nederlands](../nl/USAGE.md) | [Italiano](../it/USAGE.md)

Этот документ описывает все доступные флаги и опции для CLI-инструмента `gac`.

## Содержание

- [Использование командной строки gac](#использование-командной-строки-gac)
  - [Содержание](#содержание)
  - [Базовое использование](#базовое-использование)
  - [Флаги основного рабочего процесса](#флаги-основного-рабочего-процесса)
  - [Настройка сообщений](#настройка-сообщений)
  - [Вывод и детализация](#вывод-и-детализация)
  - [Справка и версия](#справка-и-версия)
  - [Примеры рабочих процессов](#примеры-рабочих-процессов)
  - [Расширенные возможности](#расширенные-возможности)
    - [Пропуск хуков pre-commit и lefthook](#пропуск-хуков-pre-commit-и-lefthook)
  - [Замечания по конфигурации](#замечания-по-конфигурации)
    - [Расширенные опции конфигурации](#расширенные-опции-конфигурации)
    - [Подкоманды конфигурации](#подкоманды-конфигурации)
  - [Получение справки](#получение-справки)

## Базовое использование

```sh
gac init
# Затем следуйте подсказкам для настройки вашего поставщика, модели и API-ключей в интерактивном режиме
gac
```

Генерирует сообщение коммита на основе LLM для индексированных изменений и запрашивает подтверждение. Подтверждение принимает:

- `y` или `yes` - Продолжить коммит
- `n` или `no` - Отменить коммит
- `r` или `reroll` - Пересгенерировать сообщение коммита с тем же контекстом
- `e` или `edit` - Редактировать сообщение коммита на месте с богатым редактированием в терминале (горячие клавиши vi/emacs)
- Любой другой текст - Пересгенерировать с этим текстом в качестве обратной связи (например, `сделай короче`, `сфокусируйся на производительности`)
- Пустой ввод (только Enter) - Показать подсказку снова

---

## Флаги основного рабочего процесса

| Флаг / Опция         | Короткий | Описание                                                                              |
| -------------------- | -------- | ------------------------------------------------------------------------------------- |
| `--add-all`          | `-a`     | Индексировать все изменения перед коммитом                                            |
| `--group`            | `-g`     | Группировать индексированные изменения в несколько логических коммитов                |
| `--push`             | `-p`     | Отправить изменения в удалённый репозиторий после коммита                             |
| `--yes`              | `-y`     | Автоматически подтверждать коммит без запроса                                         |
| `--dry-run`          |          | Показать, что произойдёт, не внося никаких изменений                                  |
| `--no-verify`        |          | Пропускать хуки pre-commit и lefthook при коммите                                     |
| `--skip-secret-scan` |          | Пропускать сканирование безопасности на наличие секретов в индексированных изменениях |

**Примечание:** Комбинируйте `-a` и `-g` (то есть `-ag`) для индексации ВСЕХ изменений, затем группировки их в коммиты.

**Примечание:** При использовании `--group` лимит максимальных выходных токенов автоматически масштабируется в зависимости от количества фиксируемых файлов (2x для 1-9 файлов, 3x для 10-19 файлов, 4x для 20-29 файлов, 5x для 30+ файлов). Это гарантирует, что у LLM достаточно токенов для генерации всех сгруппированных коммитов без усечения, даже для больших наборов изменений.

## Настройка сообщений

| Флаг / Опция        | Короткий | Описание                                                                       |
| ------------------- | -------- | ------------------------------------------------------------------------------ |
| `--one-liner`       | `-o`     | Генерировать однострочное сообщение коммита                                    |
| `--verbose`         | `-v`     | Генерировать подробные сообщения коммита с мотивацией, архитектурой и влиянием |
| `--hint <text>`     | `-h`     | Добавить подсказку для направления LLM                                         |
| `--model <model>`   | `-m`     | Указать модель для использования в этом коммите                                |
| `--language <lang>` | `-l`     | Переопределить язык (название или код: 'Spanish', 'es', 'zh-CN', 'ja')         |
| `--scope`           | `-s`     | Выводить соответствующую область для коммита                                   |

**Примечание:** Вы можете предоставлять обратную связь интерактивно, просто вводя её в подсказке подтверждения - нет необходимости добавлять префикс 'r'. Введите `r` для простого пересоздания, `e` для редактирования на месте с горячими клавишами vi/emacs, или введите свою обратную связь напрямую, например `сделай короче`.

## Вывод и детализация

| Флаг / Опция          | Короткий | Описание                                                             |
| --------------------- | -------- | -------------------------------------------------------------------- |
| `--quiet`             | `-q`     | Подавить весь вывод, кроме ошибок                                    |
| `--log-level <level>` |          | Установить уровень логирования (debug, info, warning, error)         |
| `--show-prompt`       |          | Показать LLM-подсказку, используемую для генерации сообщения коммита |

## Справка и версия

| Флаг / Опция | Короткий | Описание                              |
| ------------ | -------- | ------------------------------------- |
| `--version`  |          | Показать версию gac и выйти           |
| `--help`     |          | Показать справочное сообщение и выйти |

---

## Примеры рабочих процессов

- **Индексировать все изменения и закоммитить:**

  ```sh
  gac -a
  ```

- **Закоммитить и отправить за один шаг:**

  ```sh
  gac -ap
  ```

- **Сгенерировать однострочное сообщение коммита:**

  ```sh
  gac -o
  ```

- **Сгенерировать подробное сообщение коммита со структурированными разделами:**

  ```sh
  gac -v
  ```

- **Добавить подсказку для LLM:**

  ```sh
  gac -h "Рефакторинг логики аутентификации"
  ```

- **Вывести область для коммита:**

  ```sh
  gac -s
  ```

- **Группировать индексированные изменения в логические коммиты:**

  ```sh
  gac -g
  # Группирует только файлы, которые вы уже проиндексировали
  ```

- **Группировать все изменения (индексированные + неиндексированные) и автоматически подтвердить:**

  ```sh
  gac -agy
  # Индексирует всё, группирует и автоматически подтверждает
  ```

- **Использовать конкретную модель только для этого коммита:**

  ```sh
  gac -m anthropic:claude-haiku-4-5
  ```

- **Сгенерировать сообщение коммита на конкретном языке:**

  ```sh
  # Используя языковые коды (короче)
  gac -l zh-CN
  gac -l ja
  gac -l es

  # Используя полные названия
  gac -l "Simplified Chinese"
  gac -l Japanese
  gac -l Spanish
  ```

- **Тестовый запуск (увидеть, что произойдёт):**

  ```sh
  gac --dry-run
  ```

## Расширенные возможности

- Комбинируйте флаги для более мощных рабочих процессов (например, `gac -ayp` для индексации, автоматического подтверждения и отправки)
- Используйте `--show-prompt` для отладки или просмотра подсказки, отправленной в LLM
- Настраивайте детализацию с помощью `--log-level` или `--quiet`

### Пропуск хуков pre-commit и lefthook

Флаг `--no-verify` позволяет вам пропустить любые хуки pre-commit или lefthook, настроенные в вашем проекте:

```sh
gac --no-verify  # Пропустить все хуки pre-commit и lefthook
```

**Используйте `--no-verify`, когда:**

- Хуки pre-commit или lefthook временно не работают
- Работа с трудоёмкими хуками
- Коммит кода в разработке, который ещё не проходит все проверки

**Примечание:** Используйте с осторожностью, так как эти хуки поддерживают стандарты качества кода.

### Сканирование безопасности

gac включает встроенное сканирование безопасности, которое автоматически обнаруживает потенциальные секреты и API-ключи в ваших индексированных изменениях перед коммитом. Это помогает предотвратить случайный коммит конфиденциальной информации.

**Пропуск сканирования безопасности:**

```sh
gac --skip-secret-scan  # Пропустить сканирование безопасности для этого коммита
```

**Для отключения навсегда:** Установите `GAC_SKIP_SECRET_SCAN=true` в вашем файле `.gac.env`.

**Когда пропускать:**

- Коммит примеров кода с заглушками для ключей
- Работа с тестовыми фикстурами, содержащими фиктивные учётные данные
- Когда вы проверили, что изменения безопасны

**Примечание:** Сканер использует сопоставление шаблонов для обнаружения распространённых форматов секретов. Всегда просматривайте ваши индексированные изменения перед коммитом.

## Замечания по конфигурации

- Рекомендуемый способ настройки gac - запустить `gac init` и следовать интерактивным подсказкам.
- Уже настроили язык и нужно просто переключить поставщиков или модели? Запустите `gac model` для повторной настройки без вопросов о языке.
- gac загружает конфигурацию в следующем порядке приоритета:
  1. Флаги CLI
  2. Переменные окружения
  3. Уровень проекта `.gac.env`
  4. Уровень пользователя `~/.gac.env`

### Расширенные опции конфигурации

Вы можете настроить поведение gac с помощью этих дополнительных переменных окружения:

- `GAC_ALWAYS_INCLUDE_SCOPE=true` - Автоматически выводить и включать область в сообщения коммитов (например, `feat(auth):` вместо `feat:`)
- `GAC_VERBOSE=true` - Генерировать подробные сообщения коммита с разделами мотивации, архитектуры и влияния
- `GAC_TEMPERATURE=0.7` - Управлять творческостью LLM (0.0-1.0, ниже = более сфокусированно)
- `GAC_MAX_OUTPUT_TOKENS=4096` - Максимальное количество токенов для сгенерированных сообщений (автоматически масштабируется 2-5x при использовании `--group` в зависимости от количества файлов; переопределите для большего или меньшего значения)
- `GAC_WARNING_LIMIT_TOKENS=4096` - Предупреждать, когда подсказки превышают это количество токенов
- `GAC_SYSTEM_PROMPT_PATH=/path/to/custom_prompt.txt` - Использовать 自定义 системную подсказку для генерации сообщения коммита
- `GAC_LANGUAGE=Spanish` - Генерировать сообщения коммитов на конкретном языке (например, Spanish, French, Japanese, German). Поддерживает полные названия или ISO-коды (es, fr, ja, de, zh-CN). Используйте `gac language` для интерактивного выбора
- `GAC_TRANSLATE_PREFIXES=true` - Переводить префиксы обычных коммитов (feat, fix и т.д.) на целевой язык (по умолчанию: false, сохраняет префиксы на английском)
- `GAC_SKIP_SECRET_SCAN=true` - Отключить автоматическое сканирование безопасности на наличие секретов в индексированных изменениях (используйте с осторожностью)

Смотрите `.gac.env.example` для полного шаблона конфигурации.

Для подробного руководства по созданию пользовательских системных подсказок смотрите [docs/CUSTOM_SYSTEM_PROMPTS.md](docs/CUSTOM_SYSTEM_PROMPTS.md).

### Подкоманды конфигурации

Доступны следующие подкоманды:

- `gac init` — Интерактивный мастер настройки для поставщика, модели и языковой конфигурации
- `gac model` — Настройка поставщика/модели/API-ключа без подсказок языка (идеально для быстрого переключения)
- `gac config show` — Показать текущую конфигурацию
- `gac config set KEY VALUE` — Установить ключ конфигурации в `$HOME/.gac.env`
- `gac config get KEY` — Получить значение конфигурации
- `gac config unset KEY` — Удалить ключ конфигурации из `$HOME/.gac.env`
- `gac language` (или `gac lang`) — Интерактивный селектор языка для сообщений коммитов (устанавливает GAC_LANGUAGE)
- `gac diff` — Показать отфильтрованный git diff с опциями для индексированных/неиндексированных изменений, цвета и усечения

## Получение справки

- Для пользовательских системных подсказок смотрите [docs/CUSTOM_SYSTEM_PROMPTS.md](docs/CUSTOM_SYSTEM_PROMPTS.md)
- Для устранения неполадок и расширенных советов смотрите [docs/TROUBLESHOOTING.md](docs/TROUBLESHOOTING.md)
- Для установки и конфигурации смотрите [README.md#installation-and-configuration](README.md#installation-and-configuration)
- Для содействия смотрите [docs/CONTRIBUTING.md](docs/CONTRIBUTING.md)
- Информация о лицензии: [LICENSE](LICENSE)
