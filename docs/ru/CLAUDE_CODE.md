# Использование Claude Code с GAC

[English](../en/CLAUDE_CODE.md) | [简体中文](../zh-CN/CLAUDE_CODE.md) | [繁體中文](../zh-TW/CLAUDE_CODE.md) | [日本語](../ja/CLAUDE_CODE.md) | [한국어](../ko/CLAUDE_CODE.md) | [हिन्दी](../hi/CLAUDE_CODE.md) | [Tiếng Việt](../vi/CLAUDE_CODE.md) | [Français](../fr/CLAUDE_CODE.md) | **Русский** | [Español](../es/CLAUDE_CODE.md) | [Português](../pt/CLAUDE_CODE.md) | [Norsk](../no/CLAUDE_CODE.md) | [Svenska](../sv/CLAUDE_CODE.md) | [Deutsch](../de/CLAUDE_CODE.md) | [Nederlands](../nl/CLAUDE_CODE.md) | [Italiano](../it/CLAUDE_CODE.md)

GAC поддерживает аутентификацию через подписки Claude Code, позволяя вам использовать вашу подписку Claude Code вместо оплаты дорогого API Anthropic. Это идеально для пользователей, у которых уже есть доступ к Claude Code через их подписку.

## Что такое Claude Code?

Claude Code - это сервис подписки Anthropic, который предоставляет доступ к моделям Claude на основе OAuth. Вместо использования API-ключей (которые оплачиваются по токенам), Claude Code использует OAuth-токены из вашей подписки.

## Преимущества

- **Экономически эффективно**: Используйте вашу существующую подписку Claude Code вместо отдельной оплаты за доступ к API
- **Те же модели**: Доступ к тем же моделям Claude (например, `claude-sonnet-4-5`)
- **Отдельная оплата**: Использование Claude Code отделено от оплаты API Anthropic

## Настройка

GAC включает встроенную OAuth-аутентификацию для Claude Code. Процесс настройки полностью автоматизирован и откроет ваш браузер для аутентификации.

### Вариант 1: Во время начальной настройки (Рекомендуется)

При запуске `gac init` просто выберите "Claude Code" в качестве вашего провайдера:

```bash
gac init
```

Мастер выполнит следующие действия:

1. Попросит вас выбрать "Claude Code" из списка провайдеров
2. Автоматически откроет ваш браузер для OAuth-аутентификации
3. Сохранит ваш токен доступа в `~/.gac.env`
4. Установит модель по умолчанию

### Вариант 2: Переключиться на Claude Code позже

Если у вас уже настроен GAC с другим провайдером и вы хотите переключиться на Claude Code:

```bash
gac model
```

Затем:

1. Выберите "Claude Code" из списка провайдеров
2. Ваш браузер автоматически откроется для OAuth-аутентификации
3. Токен сохранён в `~/.gac.env`
4. Модель настроена автоматически

### Использовать GAC обычно

После аутентификации используйте GAC как обычно:

```bash
# Индексируйте ваши изменения
git add .

# Сгенерируйте и закоммитьте с Claude Code
gac

# Или переопределите модель для одного коммита
gac -m claude-code:claude-sonnet-4-5
```

## Доступные модели

Claude Code предоставляет доступ к тем же моделям, что и API Anthropic. Текущие модели семейства Claude 4.5 включают:

- `claude-sonnet-4-5` - Последняя и самая интеллектуальная модель Sonnet, лучшая для кодирования
- `claude-haiku-4-5` - Быстрая и эффективная
- `claude-opus-4-1` - Самая мощная модель для сложных рассуждений

Ознакомьтесь с [документацией Claude](https://docs.claude.com/en/docs/about-claude/models/overview) для полного списка доступных моделей.

## Устранение неполадок

### Токен истёк

Если вы видите ошибки аутентификации, ваш токен мог истечь. Повторно аутентифицируйтесь, выполнив:

```bash
gac auth
```

Ваш браузер автоматически откроется для новой аутентификации OAuth. Кроме того, вы можете выполнить `gac model`, выбрать "Claude Code" и выбрать "Повторная аутентификация (получить новый токен)".

### "CLAUDE_CODE_ACCESS_TOKEN не найден"

Это означает, что GAC не может найти ваш токен доступа. Аутентифицируйтесь, выполнив:

```bash
gac model
```

Затем выберите "Claude Code" из списка провайдеров. OAuth-процесс начнётся автоматически.

### "Аутентификация не удалась"

Если OAuth-аутентификация не удалась:

1. Убедитесь, что у вас есть активная подписка Claude Code
2. Проверьте, что ваш браузер открывается правильно
3. Попробуйте другой браузер, если проблемы продолжаются
4. Проверьте сетевое подключение к `claude.ai`
5. Проверьте, что порты 8765-8795 доступны для локального сервера обратного вызова

## Отличия от провайдера Anthropic

| Функция             | Anthropic (`anthropic:`)       | Claude Code (`claude-code:`)                                         |
| ------------------- | ------------------------------ | -------------------------------------------------------------------- |
| Аутентификация      | API-ключ (`ANTHROPIC_API_KEY`) | OAuth (автоматический браузерный процесс)                            |
| Оплата              | Оплата API по токенам          | На основе подписки                                                   |
| Настройка           | Ручной ввод API-ключа          | Автоматический OAuth через `gac init` или `gac model`                |
| Управление токенами | Долгосрочные API-ключи         | OAuth-токены (могут истекать, лёгкая реаутентификация через `model`) |
| Модели              | Те же модели                   | Те же модели                                                         |

## Заметки о безопасности

- **Никогда не коммитьте ваш токен доступа** в систему контроля версий
- GAC автоматически сохраняет токены в `~/.gac.env` (вне вашего каталога проекта)
- Токены могут истекать и потребуют реаутентификации через `gac model`
- OAuth-процесс использует PKCE (Proof Key for Code Exchange) для повышенной безопасности
- Локальный сервер обратного вызова работает только на localhost (порты 8765-8795)

## См. также

- [Основная документация](USAGE.md)
- [Руководство по устранению неполадок](TROUBLESHOOTING.md)
- [Документация Claude Code](https://claude.ai/code)
